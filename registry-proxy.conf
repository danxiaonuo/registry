## docker hub
server {
    # 指定监听端口
    listen 80;
    listen [::]:80;
    # 指定编码
    charset utf-8;
    # 域名
    server_name docker.iflyelf.com;
    # 开启SSL
    include /ssl/iflyelf.com/iflyelf.com.conf;
    # 禁止访问目录
    autoindex off;
    # 站点索引设置
    index forum.php index.html index.htm default.php default.htm default.html index.php;
    # 日志
    access_log logs/docker.log combined;
    error_log logs/docker.log error;

    # 路由
    location ^~ / {
             # 反向代理
             proxy_pass http://localhost:5000;
             # 关闭代理缓存功能 
             proxy_cache off;
             # 关闭缓冲
             proxy_buffering off;
	     # 禁用代理自动修改后端返回的重定向地址（保持后端原始 Location/Refresh 不被改写）
	     proxy_redirect off;
             # nginx跟后端服务器连接超时时间
             proxy_connect_timeout 300s;
             # 后端服务器的数据回传时间
             proxy_send_timeout 7200s;
             # 连接成功后，后端服务器响应时间
             proxy_read_timeout 7200s;
             # 向客户端发送响应时的超时时间
             send_timeout 300s;
	     # 将原始的 Host 头转发给后端，保持域名一致（避免后端识别错误）
	     proxy_set_header Host $host;
	     # 将客户端的真实 IP 传给后端服务，而不是 Nginx 的 IP
             proxy_set_header X-Real-IP $remote_addr;
	     # 保留代理链路中的所有真实来源 IP，用于日志、审计等
             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
	     # 自定义头，标记此请求经过 Nginx 代理（可用于后端逻辑判断）
             proxy_set_header X-Nginx-Proxy true;
             # 日志
             access_log logs/docker.log combined;
             error_log logs/docker.log notice;
    }

    # 访问限制
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }
    # 拒绝所有访问隐藏文件的尝试
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    # 缓存文件
    location ~* \.ico$ {
        expires -1;
    }
    location ~* \.(htm|html|gif|js|css|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma|gz|svg|mp4|ogg|ogv|webm|htc|xml|woff)$     {
        expires -1;
    }
    location ~ /(app\/|conf[^\.]|include\/|local\/|locale\/) {
        deny all;
        return 404;
    }
}

## quay
server {
    # 指定监听端口
    listen 80;
    listen [::]:80;
    # 指定编码
    charset utf-8;
    # 域名
    server_name quay.iflyelf.com;
    # 开启SSL
    include /ssl/iflyelf.com/iflyelf.com.conf;
    # 禁止访问目录
    autoindex off;
    # 站点索引设置
    index forum.php index.html index.htm default.php default.htm default.html index.php;
    # 日志
    access_log logs/quay.log combined;
    error_log logs/quay.log error;

    # 路由
    location ^~ / {
             # 反向代理
             proxy_pass http://localhost:5001;
             # 关闭代理缓存功能
             proxy_cache off;
             # 关闭缓冲
             proxy_buffering off;
             # 禁用代理自动修改后端返回的重定向地址（保持后端原始 Location/Refresh 不被改写）
             proxy_redirect off;
             # nginx跟后端服务器连接超时时间
             proxy_connect_timeout 300s;
             # 后端服务器的数据回传时间
             proxy_send_timeout 7200s;
             # 连接成功后，后端服务器响应时间
             proxy_read_timeout 7200s;
             # 向客户端发送响应时的超时时间
             send_timeout 300s;
             # 将原始的 Host 头转发给后端，保持域名一致（避免后端识别错误）
             proxy_set_header Host $host;
             # 将客户端的真实 IP 传给后端服务，而不是 Nginx 的 IP
             proxy_set_header X-Real-IP $remote_addr;
             # 保留代理链路中的所有真实来源 IP，用于日志、审计等
             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
             # 自定义头，标记此请求经过 Nginx 代理（可用于后端逻辑判断）
             proxy_set_header X-Nginx-Proxy true;
             # 日志
             access_log logs/quay.log combined;
             error_log logs/quay.log notice;
    }

    # 访问限制
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }
    # 拒绝所有访问隐藏文件的尝试
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    # 缓存文件
    location ~* \.ico$ {
        expires -1;
    }
    location ~* \.(htm|html|gif|js|css|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma|gz|svg|mp4|ogg|ogv|webm|htc|xml|woff)$     {
        expires -1;
    }
    location ~ /(app\/|conf[^\.]|include\/|local\/|locale\/) {
        deny all;
        return 404;
    }
}

## gcr
server {
    # 指定监听端口
    listen 80;
    listen [::]:80;
    # 指定编码
    charset utf-8;
    # 域名
    server_name gcr.iflyelf.com;
    # 开启SSL
    include /ssl/iflyelf.com/iflyelf.com.conf;
    # 禁止访问目录
    autoindex off;
    # 站点索引设置
    index forum.php index.html index.htm default.php default.htm default.html index.php;
    # 日志
    access_log logs/gcr.log combined;
    error_log logs/gcr.log error;

    # 路由
    location ^~ / {
             # 反向代理
             proxy_pass http://localhost:5002;
             # 关闭代理缓存功能
             proxy_cache off;
             # 关闭缓冲
             proxy_buffering off;
             # 禁用代理自动修改后端返回的重定向地址（保持后端原始 Location/Refresh 不被改写）
             proxy_redirect off;
             # nginx跟后端服务器连接超时时间
             proxy_connect_timeout 300s;
             # 后端服务器的数据回传时间
             proxy_send_timeout 7200s;
             # 连接成功后，后端服务器响应时间
             proxy_read_timeout 7200s;
             # 向客户端发送响应时的超时时间
             send_timeout 300s;
             # 将原始的 Host 头转发给后端，保持域名一致（避免后端识别错误）
             proxy_set_header Host $host;
             # 将客户端的真实 IP 传给后端服务，而不是 Nginx 的 IP
             proxy_set_header X-Real-IP $remote_addr;
             # 保留代理链路中的所有真实来源 IP，用于日志、审计等
             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
             # 自定义头，标记此请求经过 Nginx 代理（可用于后端逻辑判断）
             proxy_set_header X-Nginx-Proxy true;
             # 日志
             access_log logs/gcr.log combined;
             error_log logs/gcr.log notice;
    }

    # 访问限制
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }
    # 拒绝所有访问隐藏文件的尝试
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    # 缓存文件
    location ~* \.ico$ {
        expires -1;
    }
    location ~* \.(htm|html|gif|js|css|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma|gz|svg|mp4|ogg|ogv|webm|htc|xml|woff)$     {
        expires -1;
    }
    location ~ /(app\/|conf[^\.]|include\/|local\/|locale\/) {
        deny all;
        return 404;
    }
}

## k8s-gcr
server {
    # 指定监听端口
    listen 80;
    listen [::]:80;
    # 指定编码
    charset utf-8;
    # 域名
    server_name k8s-gcr.iflyelf.com;
    # 开启SSL
    include /ssl/iflyelf.com/iflyelf.com.conf;
    # 禁止访问目录
    autoindex off;
    # 站点索引设置
    index forum.php index.html index.htm default.php default.htm default.html index.php;
    # 日志
    access_log logs/k8s-gcr.log combined;
    error_log logs/k8s-gcr.log error;

    # 路由
    location ^~ / {
             # 反向代理
             proxy_pass http://localhost:5003;
             # 关闭代理缓存功能 
             proxy_cache off;
             # 关闭缓冲
             proxy_buffering off;
             # 禁用代理自动修改后端返回的重定向地址（保持后端原始 Location/Refresh 不被改写）
             proxy_redirect off;
             # nginx跟后端服务器连接超时时间
             proxy_connect_timeout 300s;
             # 后端服务器的数据回传时间
             proxy_send_timeout 7200s;
             # 连接成功后，后端服务器响应时间
             proxy_read_timeout 7200s;
             # 向客户端发送响应时的超时时间
             send_timeout 300s;
             # 将原始的 Host 头转发给后端，保持域名一致（避免后端识别错误）
             proxy_set_header Host $host;
             # 将客户端的真实 IP 传给后端服务，而不是 Nginx 的 IP
             proxy_set_header X-Real-IP $remote_addr;
             # 保留代理链路中的所有真实来源 IP，用于日志、审计等
             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
             # 自定义头，标记此请求经过 Nginx 代理（可用于后端逻辑判断）
             proxy_set_header X-Nginx-Proxy true;
             # 日志
             access_log logs/k8s-gcr.log combined;
             error_log logs/k8s-gcr.log notice;
    }

    # 访问限制
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }
    # 拒绝所有访问隐藏文件的尝试
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    # 缓存文件
    location ~* \.ico$ {
        expires -1;
    }
    location ~* \.(htm|html|gif|js|css|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma|gz|svg|mp4|ogg|ogv|webm|htc|xml|woff)$     {
        expires -1;
    }
    location ~ /(app\/|conf[^\.]|include\/|local\/|locale\/) {
        deny all;
        return 404;
    }
}

## k8s
server {
    # 指定监听端口
    listen 80;
    listen [::]:80;
    # 指定编码
    charset utf-8;
    # 域名
    server_name k8s.iflyelf.com;
    # 开启SSL
    include /ssl/iflyelf.com/iflyelf.com.conf;
    # 禁止访问目录
    autoindex off;
    # 站点索引设置
    index forum.php index.html index.htm default.php default.htm default.html index.php;
    # 日志
    access_log logs/k8s.log combined;
    error_log logs/k8s.log error;

    # 路由
    location ^~ / {
             # 反向代理
             proxy_pass http://localhost:5004;
             # 关闭代理缓存功能
             proxy_cache off;
             # 关闭缓冲
             proxy_buffering off;
             # 禁用代理自动修改后端返回的重定向地址（保持后端原始 Location/Refresh 不被改写）
             proxy_redirect off;
             # nginx跟后端服务器连接超时时间
             proxy_connect_timeout 300s;
             # 后端服务器的数据回传时间
             proxy_send_timeout 7200s;
             # 连接成功后，后端服务器响应时间
             proxy_read_timeout 7200s;
             # 向客户端发送响应时的超时时间
             send_timeout 300s;
             # 将原始的 Host 头转发给后端，保持域名一致（避免后端识别错误）
             proxy_set_header Host $host;
             # 将客户端的真实 IP 传给后端服务，而不是 Nginx 的 IP
             proxy_set_header X-Real-IP $remote_addr;
             # 保留代理链路中的所有真实来源 IP，用于日志、审计等
             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
             # 自定义头，标记此请求经过 Nginx 代理（可用于后端逻辑判断）
             proxy_set_header X-Nginx-Proxy true;
             # 日志
             access_log logs/k8s.log combined;
             error_log logs/k8s.log notice;
    }

    # 访问限制
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }
    # 拒绝所有访问隐藏文件的尝试
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    # 缓存文件
    location ~* \.ico$ {
        expires -1;
    }
    location ~* \.(htm|html|gif|js|css|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma|gz|svg|mp4|ogg|ogv|webm|htc|xml|woff)$     {
        expires -1;
    }
    location ~ /(app\/|conf[^\.]|include\/|local\/|locale\/) {
        deny all;
        return 404;
    }
}

## ghcr
server {
    # 指定监听端口
    listen 80;
    listen [::]:80;
    # 指定编码
    charset utf-8;
    # 域名
    server_name ghcr.iflyelf.com;
    # 开启SSL
    include /ssl/iflyelf.com/iflyelf.com.conf;
    # 禁止访问目录
    autoindex off;
    # 站点索引设置
    index forum.php index.html index.htm default.php default.htm default.html index.php;
    # 日志
    access_log logs/ghcr.log combined;
    error_log logs/ghcr.log error;

    # 路由
    location ^~ / {
             # 反向代理
             proxy_pass http://localhost:5005;
             # 关闭代理缓存功能
             proxy_cache off;
             # 关闭缓冲
             proxy_buffering off;
             # 禁用代理自动修改后端返回的重定向地址（保持后端原始 Location/Refresh 不被改写）
             proxy_redirect off;
             # nginx跟后端服务器连接超时时间
             proxy_connect_timeout 300s;
             # 后端服务器的数据回传时间
             proxy_send_timeout 7200s;
             # 连接成功后，后端服务器响应时间
             proxy_read_timeout 7200s;
             # 向客户端发送响应时的超时时间
             send_timeout 300s;
             # 将原始的 Host 头转发给后端，保持域名一致（避免后端识别错误）
             proxy_set_header Host $host;
             # 将客户端的真实 IP 传给后端服务，而不是 Nginx 的 IP
             proxy_set_header X-Real-IP $remote_addr;
             # 保留代理链路中的所有真实来源 IP，用于日志、审计等
             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
             # 自定义头，标记此请求经过 Nginx 代理（可用于后端逻辑判断）
             proxy_set_header X-Nginx-Proxy true;
             # 日志
             access_log logs/ghcr.log combined;
             error_log logs/ghcr.log notice;
    }

    # 访问限制
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }
    # 拒绝所有访问隐藏文件的尝试
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    # 缓存文件
    location ~* \.ico$ {
        expires -1;
    }
    location ~* \.(htm|html|gif|js|css|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma|gz|svg|mp4|ogg|ogv|webm|htc|xml|woff)$     {
        expires -1;
    }
    location ~ /(app\/|conf[^\.]|include\/|local\/|locale\/) {
        deny all;
        return 404;
    }
}

## cloudsmith
server {
    # 指定监听端口
    listen 80;
    listen [::]:80;
    # 指定编码
    charset utf-8;
    # 域名
    server_name cloudsmith.iflyelf.com;
    # 开启SSL
    include /ssl/iflyelf.com/iflyelf.com.conf;
    # 禁止访问目录
    autoindex off;
    # 站点索引设置
    index forum.php index.html index.htm default.php default.htm default.html index.php;
    # 日志
    access_log logs/cloudsmith.log combined;
    error_log logs/cloudsmith.log error;

    # 路由
    location ^~ / {
             # 反向代理
             proxy_pass http://localhost:5006;
             # 关闭代理缓存功能
             proxy_cache off;
             # 关闭缓冲
             proxy_buffering off;
             # 禁用代理自动修改后端返回的重定向地址（保持后端原始 Location/Refresh 不被改写）
             proxy_redirect off;
             # nginx跟后端服务器连接超时时间
             proxy_connect_timeout 300s;
             # 后端服务器的数据回传时间
             proxy_send_timeout 7200s;
             # 连接成功后，后端服务器响应时间
             proxy_read_timeout 7200s;
             # 向客户端发送响应时的超时时间
             send_timeout 300s;
             # 将原始的 Host 头转发给后端，保持域名一致（避免后端识别错误）
             proxy_set_header Host $host;
             # 将客户端的真实 IP 传给后端服务，而不是 Nginx 的 IP
             proxy_set_header X-Real-IP $remote_addr;
             # 保留代理链路中的所有真实来源 IP，用于日志、审计等
             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
             # 自定义头，标记此请求经过 Nginx 代理（可用于后端逻辑判断）
             proxy_set_header X-Nginx-Proxy true;
             # 日志
             access_log logs/cloudsmith.log combined;
             error_log logs/cloudsmith.log notice;
    }

    # 访问限制
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }
    # 拒绝所有访问隐藏文件的尝试
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    # 缓存文件
    location ~* \.ico$ {
        expires -1;
    }
    location ~* \.(htm|html|gif|js|css|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma|gz|svg|mp4|ogg|ogv|webm|htc|xml|woff)$     {
        expires -1;
    }
    location ~ /(app\/|conf[^\.]|include\/|local\/|locale\/) {
        deny all;
        return 404;
    }
}

## ecr
server {
    # 指定监听端口
    listen 80;
    listen [::]:80;
    # 指定编码
    charset utf-8;
    # 域名
    server_name ecr.iflyelf.com;
    # 开启SSL
    include /ssl/iflyelf.com/iflyelf.com.conf;
    # 禁止访问目录
    autoindex off;
    # 站点索引设置
    index forum.php index.html index.htm default.php default.htm default.html index.php;
    # 日志
    access_log logs/ecr.log combined;
    error_log logs/ecr.log error;

    # 路由
    location ^~ / {
             # 反向代理
             proxy_pass http://localhost:5007;
             # 关闭代理缓存功能
             proxy_cache off;
             # 关闭缓冲
             proxy_buffering off;
             # 禁用代理自动修改后端返回的重定向地址（保持后端原始 Location/Refresh 不被改写）
             proxy_redirect off;
             # nginx跟后端服务器连接超时时间
             proxy_connect_timeout 300s;
             # 后端服务器的数据回传时间
             proxy_send_timeout 7200s;
             # 连接成功后，后端服务器响应时间
             proxy_read_timeout 7200s;
             # 向客户端发送响应时的超时时间
             send_timeout 300s;
             # 将原始的 Host 头转发给后端，保持域名一致（避免后端识别错误）
             proxy_set_header Host $host;
             # 将客户端的真实 IP 传给后端服务，而不是 Nginx 的 IP
             proxy_set_header X-Real-IP $remote_addr;
             # 保留代理链路中的所有真实来源 IP，用于日志、审计等
             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
             # 自定义头，标记此请求经过 Nginx 代理（可用于后端逻辑判断）
             proxy_set_header X-Nginx-Proxy true;
             # 日志
             access_log logs/ecr.log combined;
             error_log logs/ecr.log notice;
    }

    # 访问限制
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }
    # 拒绝所有访问隐藏文件的尝试
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    # 缓存文件
    location ~* \.ico$ {
        expires -1;
    }
    location ~* \.(htm|html|gif|js|css|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma|gz|svg|mp4|ogg|ogv|webm|htc|xml|woff)$     {
        expires -1;
    }
    location ~ /(app\/|conf[^\.]|include\/|local\/|locale\/) {
        deny all;
        return 404;
    }
}

## nvcr
server {
    # 指定监听端口
    listen 80;
    listen [::]:80;
    # 指定编码
    charset utf-8;
    # 域名
    server_name nvcr.iflyelf.com;
    # 开启SSL
    include /ssl/iflyelf.com/iflyelf.com.conf;
    # 禁止访问目录
    autoindex off;
    # 站点索引设置
    index forum.php index.html index.htm default.php default.htm default.html index.php;
    # 日志
    access_log logs/nvcr.log combined;
    error_log logs/nvcr.log error;

    # 路由
    location ^~ / {
             # 反向代理
             proxy_pass http://localhost:5008;
             # 关闭代理缓存功能
             proxy_cache off;
             # 关闭缓冲
             proxy_buffering off;
             # 禁用代理自动修改后端返回的重定向地址（保持后端原始 Location/Refresh 不被改写）
             proxy_redirect off;
             # nginx跟后端服务器连接超时时间
             proxy_connect_timeout 300s;
             # 后端服务器的数据回传时间
             proxy_send_timeout 7200s;
             # 连接成功后，后端服务器响应时间
             proxy_read_timeout 7200s;
             # 向客户端发送响应时的超时时间
             send_timeout 300s;
             # 将原始的 Host 头转发给后端，保持域名一致（避免后端识别错误）
             proxy_set_header Host $host;
             # 将客户端的真实 IP 传给后端服务，而不是 Nginx 的 IP
             proxy_set_header X-Real-IP $remote_addr;
             # 保留代理链路中的所有真实来源 IP，用于日志、审计等
             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
             # 自定义头，标记此请求经过 Nginx 代理（可用于后端逻辑判断）
             proxy_set_header X-Nginx-Proxy true;
             # 日志
             access_log logs/nvcr.log combined;
             error_log logs/nvcr.log notice;
    }

    # 访问限制
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }
    # 拒绝所有访问隐藏文件的尝试
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    # 缓存文件
    location ~* \.ico$ {
        expires -1;
    }
    location ~* \.(htm|html|gif|js|css|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma|gz|svg|mp4|ogg|ogv|webm|htc|xml|woff)$     {
        expires -1;
    }
    location ~ /(app\/|conf[^\.]|include\/|local\/|locale\/) {
        deny all;
        return 404;
    }
}

